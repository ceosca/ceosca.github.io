<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproductor de MPD con cifrado oct</title>
    <script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
</head>
<body>
    <video id="videoPlayer" controls autoplay></video>

    <script>
        var mpdUrl = "https://edge-mix02-mun.cvattv.com.ar/live/c7eds/A3_Series/SA_Live_dash_enc_2A/A3_Series.mpd";
        var jsonUrl = "https://listasm3u.live/arkey/A3_Series.json";

        fetch(jsonUrl)
            .then(response => response.json())
            .then(data => {
                var key = data.keys[0].k;
                var keyId = data.keys[0].kid;

                var player = dashjs.MediaPlayer().create();
                player.initialize(document.querySelector("#videoPlayer"), mpdUrl, true);
                player.setProtectionData({
                    "com.widevine.alpha": {
                        "serverURL": "https://widevine-proxy.appspot.com/proxy"
                    },
                    "com.microsoft.playready": {
                        "serverURL": "https://playready.directtaps.net/pr/svc/rightsmanager.asmx?PlayRight=1&UseSimpleNonPersistentLicense=1"
                    },
                    "org.w3.clearkey": {
                        "serverURL": null,
                        "clearkeys": [{
                            "kid": keyId,
                            "k": key
                        }]
                    }
                });
            })
            .catch(error => console.error('Error al cargar el JSON:', error));
    </script>
</body>
</html>
