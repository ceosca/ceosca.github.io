<!DOCTYPE html>
<html>
<head>
    <title>RAPSVP</title> <!-- Reproductor de Audio de Streams de Video Podrido -->
    <script type='text/javascript' src="//ssl.p.jwpcdn.com/player/v/8.25.0/jwplayer.js"></script>
    <script type='text/javascript'>jwplayer.key='XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo'</script>
    <style>#ctls{margin-top:10px;}</style>
</head>
<body>
    <div>
        <label for="cs">Cat:</label>
        <select id="cs" onchange="ucl()"></select>
    </div>
    <div>
        <label for="chs">Chn:</label>
        <select id="chs" onchange="ls()"></select>
    </div>
    <div id="p">LOAD...</div>
    <div id="ctls">
        <button onclick="pp()">P/P</button>
        <button onclick="cv(-5)">V-</button>
        <button onclick="cv(5)">V+</button>
    </div>
    <script type='text/javascript'>
        var pi=null, cns=[], cts=[];
        fetch('https://ceosca.github.io/audio/canales.json')
            .then(r=>r.json())
            .then(d=>{
                cns=d;
                cts=gco();
                lc();
                ucl();
            })
            .catch(e=>console.error('Err:',e));

        function lc(){
            var sb=document.getElementById("cs");
            cts.forEach(function(ct){
                var o=document.createElement("option");
                o.text=ct;sb.add(o);
            });
        }
        function gco(){
            var cs=new Set();
            cns.forEach(function(cn){cs.add(cn.categoria);});
            return Array.from(cs).sort();
        }
        function ucl(){
            var sc=document.getElementById("cs").value;
            var chs=document.getElementById("chs");
            chs.innerHTML="";
            var fc=cns.filter(function(cn){return cn.categoria===sc;});
            fc.sort(function(a,b){return a.nombre.localeCompare(b.nombre);});
            fc.forEach(function(cn){
                var o=document.createElement("option");
                o.text=cn.nombre;
                o.value=JSON.stringify(cn);
                chs.add(o);
            });
            if(fc.length>0){ls();}
        }
        function ls(){
            var sb=document.getElementById("chs");
            var sv=JSON.parse(sb.value);
            var cfg={playlist:[{title:"AudStrm",sources:[{file:sv.url,type:"hls"}],tracks:[]}],width:1,height:1,autostart:true,controls:false};
            pi=jwplayer("p").setup(cfg);
        }
        function pp(){if(pi.getState()==="playing"){pi.pause();}else{pi.play();}}
        function cv(a){var v=pi.getVolume();pi.setVolume(Math.max(0,Math.min(100,v+a)));}
    </script>
</body>
</html>